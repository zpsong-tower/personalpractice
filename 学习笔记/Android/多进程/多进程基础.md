# 多进程基础

当一个应用在开始运行时，系统会为它创建一个进程，一个应用默认只有一个进程，这个进程（主进程）的名称就是应用的包名。

**进程的特点：**

- 进程是系统资源和分配的基本单位，而线程是调度的基本单位
- 每个进程都有自己独立的资源和内存空间
- 其它进程不能任意访问当前进程的内存和资源
- 系统给每个进程分配的内存会有限制

**为何要使用多进程：**

- 分散内存的占用
- 项目多模块解耦
- 子进程崩溃，主进程可以继续工作
- 主进程退出，子进程可以继续工作
- 实现守护进程，防杀保活

### Android中实现多进程

1. 私有进程 (`android:process` 的值以**冒号**开头)

    其他应用的组件不可以和它跑在同一个进程中

    ```xml
    <service android:name=".ProcessTestService" android:process=":secondProcess"/>
    ```

2. 公有进程 (`android:process`的值以**小写字母**开头)

    其他应用通过设置相同的ShareUID可以和它跑在同一个进程

    ```xml
    <service android:name=".ProcessTestService" android:process="com.secondProcess"/>
    ```

3. 全局初始化时，多进程会被初始化多次，需要判断当前进程，然后做相应的初始化操作

### 进程优先级

1. 前台进程
2. 可见进程
3. 服务进程
4. 后台进程
5. 空进程 (出于缓存的目的而被保留)

